---
title: "YOTJ TryHackMe" 
date: 2025-09-1 00:50:00 0000+
tags: [WriteUp, YearOfTheJellyfish, THM,  Enumeration, CVE, DirtySock, OldSoftware, Unpatched,Privilege Escalation, Linux]
categories: [WriteUps, TryHackMe]
image:
  path: /assets/images/YOTJ_THM/preview_yotj.png
---
# Year of the Jellyfish THM Writeup

**Year of the Jellyfish** is a linux box on tryhackme which focuses on the remote code execution through an old software version to get on the box upon further enumeration reveals that the system is vulnerable to the 2019 dirty sock vulnerability, exploiting it gives us the system shell on the machine.

![image.png](/assets/images/YOTJ_THM/image.png)

## Initial Enumeration

We have received a public IP address when the box spun up.

As always we are gonna start off with the rustmap to find the open ports and services running on the box.

```bash
rustmap.py -ip 44.223.37.148
```

![image.png](/assets/images/YOTJ_THM/image%201.png)

![image.png](/assets/images/YOTJ_THM/image%202.png)

![image.png](/assets/images/YOTJ_THM/image%203.png)

Looking at the results we have several ports open namely FTP, SSH, WEB ports.

Other important information found is the domain name and the subdomains are **robyns-petshop.thm, monitorr.robyns-petshop.thm, beta.robyns-petshop.thm, dev.robyns-petshop.thm.** I will add all the subdomains and domain names to my /etc/hosts file.

There is also a potential email address found in the scan â†’ robyn@robyns-petshop.thm

## Exploitation and Enumeration

### robyns-petshop.thm

We have a numerous web ports open on the box, visiting the [https://robyns-petshop.thm](https://robyns-petshop.thm), we have this page.

![image.png](/assets/images/YOTJ_THM/image%204.png)

Checked the source code, doesnâ€™t helped much.

Lets do some quick directory busting on the domain using gobuster.

```bash
gobuster dir -u https://robyns-petshop.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 100 -k
```

![image.png](/assets/images/YOTJ_THM/image%205.png)

But nothing useful found on these pages.

### Monitorr.robyn-petshop.thm

Visiting the monitorr page we have this monitoring portal for the 2 services running on the domain.

![image.png](/assets/images/YOTJ_THM/image%206.png)

It also has the **Monitor Settings** tab which points to the settings.php visiting there leads us to this page.

![image.png](/assets/images/YOTJ_THM/image%207.png)

And we have a login page.

Lets search for any potential vulnerabilities for this Monitorr 1.7.6m version.

Using searchsploit.

```bash
searchsploit monitorr
```

![image.png](/assets/images/YOTJ_THM/image%208.png)

We have remote code execution unauthenticated.

Lets try to exploit this.

I will clone this [https://github.com/jayngng/monitorr-v1.7.6m-rce](https://github.com/jayngng/monitorr-v1.7.6m-rce) script from github.

```bash
python3 monitorr.py
```

![image.png](/assets/images/YOTJ_THM/image%209.png)

Received a hit back.

![image.png](/assets/images/YOTJ_THM/image%2010.png)

We have a shell on the box.

Lets now stabilize our shell.

```bash
python3 -c 'import pty;pty.spawn("/bin/bash")'
```

Now lets get some permissions to clear the screen

```bash
export TERM=xterm
```

![image.png](/assets/images/YOTJ_THM/image%2011.png)

Lets also set the stty rows and columns size here.

```bash
ctrl + Z # to background our shell
stty raw -echo;fg
```

![image.png](/assets/images/YOTJ_THM/image%2012.png)

setting stty size now.

```bash
stty rows 120 cols 120
```

Now lets enumerate the users on the box.

```bash
cat /etc/passwd | grep "bash"
```

![image.png](/assets/images/YOTJ_THM/image%2013.png)

We only have one user **Robyn.**

Now lets search for some potential passwords on the box.

There is a file in the monitorrâ€™s directory named datausers.db.

![image.png](/assets/images/YOTJ_THM/image%2014.png)

I downloaded it and opened in the SQLiteBrowser.

![image.png](/assets/images/YOTJ_THM/image%2015.png)

Gave me this hash, lets try to crack it using hashcat.

```bash
hashcat -m 3200 hashes.txt /usr/share/worlists/rockyou.txt
```

Hashcat was not successful in cracking the hash.

However, we have our first flag in the /var/www directory.

![image.png](/assets/images/YOTJ_THM/image%2016.png)

## Privilege Escalation

### Shell as Root

I didnâ€™t find any potential password on the box, and I had no clue about the jellyfish service that is running on the box.

See thisâ†’

![image.png](/assets/images/YOTJ_THM/image%2017.png)

This service is running on port 8096 and I got no clue what to do with so lets just upload [linpeas.sh](http://linpeas.sh) and look for potential privilege escalation methods.

![image.png](/assets/images/YOTJ_THM/image%2018.png)

I will wget the file on our reverse shell in the /dev/shm folder.

![image.png](/assets/images/YOTJ_THM/image%2019.png)

Looking at the [Linpeas.sh](http://Linpeas.sh) output we have this,

![image.png](/assets/images/YOTJ_THM/image%2020.png)

It is probably vulnerable to the **dirty_sock exploit.**

![image.png](/assets/images/YOTJ_THM/image%2021.png)

There are also a numerous exploit to which this box is exploitable, lets try to exploit it using dirtysock.

We are going to be using this exploit.

[https://github.com/initstring/dirty_sock](https://github.com/initstring/dirty_sock)

```bash
git clone https://github.com/initstring/dirty_sock.git
```

Now I will transfer this exploit to our /dev/shm location on the vulnerable system.

![image.png](/assets/images/YOTJ_THM/image%2022.png)

Running our python script.

```bash
python3 dirty_sockv2.py
```

![image.png](/assets/images/YOTJ_THM/image%2023.png)

It resulted in an error.

But we have a new user created named **dirty_sock** with a password of **dirty_sock.**

![image.png](/assets/images/YOTJ_THM/image%2024.png)

Lets cat our root flag.

![image.png](/assets/images/YOTJ_THM/image%2025.png)

Rooted!

![image.png](/assets/images/YOTJ_THM/image%2026.png)

Thanks for reading ðŸ˜Š
